<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Prediksi Roulette 18 Angka Terstruktur</title>
  <style>
    body { font-family: Arial; padding: 15px; background: #f4f4f4; max-width: 600px; margin: auto; }
    textarea, input, button { margin-top: 10px; padding: 10px; width: 100%; box-sizing: border-box; }
    table { width: 100%; margin-top: 20px; border-collapse: collapse; font-size: 14px; }
    th, td { padding: 8px; border: 1px solid #ccc; text-align: center; }
    th { background-color: #333; color: white; }
    .red-number { color: #b22222; font-weight: bold; }
    .black-number { color: #000; font-weight: bold; }
    .green-number { color: #006400; font-weight: bold; }
    .highlight { background-color: #eaffea; }
  </style>
</head>
<body>

<h2>üéØ Prediksi Roulette 18 Angka</h2>

<label>Masukkan Riwayat Angka (pisahkan dengan koma):</label>
<textarea id="historyInput" rows="5" placeholder="Contoh: 0,23,5,14,8,..."></textarea>

<label>Hasil Terbaru (pisahkan dengan koma/spasi):</label>
<input type="text" id="latestResult" placeholder="Contoh: 10,20,30" />

<button onclick="generatePrediction()">üîç Proses Prediksi</button>

<table>
  <thead>
    <tr>
      <th>Angka</th>
      <th>Warna</th>
      <th>Kolom</th>
      <th>Besar/Kecil</th>
      <th>Ganjil/Genap</th>
    </tr>
  </thead>
  <tbody id="resultTable"></tbody>
</table>

<script>
  const red = new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]);
  const green = 0;

  function getColor(n) {
    if (n === 0) return "Hijau";
    if (red.has(n)) return "Merah";
    return "Hitam";
  }

  function getColumn(n) {
    if (n >= 1 && n <= 12) return 1;
    if (n >= 13 && n <= 24) return 2;
    if (n >= 25 && n <= 36) return 3;
    return "-";
  }

  function isBesar(n) { return n >= 19 && n <= 36; }
  function isKecil(n) { return n >= 1 && n <= 18; }

  function isGanjil(n) { return n % 2 === 1; }
  function isGenap(n) { return n % 2 === 0 && n !== 0; }

  function generatePrediction() {
    const historyInput = document.getElementById("historyInput").value;
    const latestInput = document.getElementById("latestResult").value;

    const history = historyInput.split(",").map(n => parseInt(n.trim())).filter(n => !isNaN(n));
    const latest = latestInput.split(/[\s,]+/).map(n => parseInt(n.trim())).filter(n => !isNaN(n));

    const combined = [...history, ...latest];
    if (combined.length === 0) {
      alert("Masukkan riwayat atau hasil terbaru.");
      return;
    }

    const freq = Array(37).fill(0);
    combined.forEach(n => freq[n]++);

    const all = Array.from({length: 37}, (_, i) => i);

    // Statistik dominan
    const count = {
      merah: 0, hitam: 0, hijau: 0,
      ganjil: 0, genap: 0,
      besar: 0, kecil: 0,
      kolom: {1:0,2:0,3:0}
    };

    combined.forEach(n => {
      const color = getColor(n).toLowerCase();
      count[color]++;
      if (isGanjil(n)) count.ganjil++;
      else if (isGenap(n)) count.genap++;
      if (isBesar(n)) count.besar++;
      else if (isKecil(n)) count.kecil++;
      const col = getColumn(n);
      if (col !== "-") count.kolom[col]++;
    });

    // Tentukan dominan
    const warnaDom = Object.entries({merah:count.merah, hitam:count.hitam}).sort((a,b)=>b[1]-a[1])[0][0];
    const genapGanjilDom = count.ganjil >= count.genap ? "ganjil" : "genap";
    const besarKecilDom = count.besar >= count.kecil ? "besar" : "kecil";
    const kolomDom = Object.entries(count.kolom).sort((a,b)=>b[1]-a[1])[0][0];

    const hasil = [];
    const sudah = new Set();

    function tambah(n) {
      if (!sudah.has(n) && hasil.length < 18) {
        sudah.add(n);
        hasil.push(n);
      }
    }

    // 1. Tambahkan 0
    tambah(0);

    // 2. Tambahkan 3 hasil terbaru
    latest.forEach(tambah);

    // 3. Tambah dari warna dominan
    all.filter(n => getColor(n).toLowerCase() === warnaDom).forEach(tambah);

    // 4. Tambah dari ganjil/genap dominan
    all.filter(n => genapGanjilDom === "ganjil" ? isGanjil(n) : isGenap(n)).forEach(tambah);

    // 5. Tambah dari besar/kecil dominan
    all.filter(n => besarKecilDom === "besar" ? isBesar(n) : isKecil(n)).forEach(tambah);

    // 6. Tambah dari kolom dominan
    all.filter(n => getColumn(n) == kolomDom).forEach(tambah);

    // Hasilkan tabel
    const tbody = document.getElementById("resultTable");
    tbody.innerHTML = "";
    hasil.slice(0, 18).forEach(n => {
      const row = document.createElement("tr");
      const colorClass = n === 0 ? "green-number" : red.has(n) ? "red-number" : "black-number";
      row.innerHTML = `
        <td class="${colorClass}">${n}</td>
        <td>${getColor(n)}</td>
        <td>${getColumn(n)}</td>
        <td>${isBesar(n) ? "Besar" : isKecil(n) ? "Kecil" : "-"}</td>
        <td>${isGanjil(n) ? "Ganjil" : isGenap(n) ? "Genap" : "-"}</td>
      `;
      tbody.appendChild(row);
    });

    // Update textarea (auto tambah hasil baru ke history)
    const updatedHistory = [...history, ...latest].slice(-100); // Max 100 riwayat
    document.getElementById("historyInput").value = updatedHistory.join(",");
    document.getElementById("latestResult").value = "";
  }
</script>

</body>
</html>
