<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Prediksi Roulette 18 Angka + Statistik Menang/Kalah</title>
  <style>
    body { font-family: Arial; padding: 15px; background: #f4f4f4; max-width: 600px; margin: auto; }
    textarea, input, button { margin-top: 10px; padding: 10px; width: 100%; box-sizing: border-box; font-size: 16px; }
    table { width: 100%; margin-top: 20px; border-collapse: collapse; font-size: 14px; }
    th, td { padding: 8px; border: 1px solid #ccc; text-align: center; }
    th { background-color: #333; color: white; }
    .red-number { color: #b22222; font-weight: bold; }
    .black-number { color: #000; font-weight: bold; }
    .green-number { color: #006400; font-weight: bold; }
    .stats-container { margin-top: 20px; background: #fff; padding: 15px; border-radius: 6px; box-shadow: 0 0 6px rgba(0,0,0,0.1); font-size: 18px; text-align: center; }
    .btn-reset { margin-top: 10px; padding: 10px 20px; font-size: 16px; cursor: pointer; border: none; border-radius: 4px; background-color: #007bff; color: white; }
    .btn-reset:hover { opacity: 0.85; }
  </style>
</head>
<body>

<h2>sabar ya allah</h2>

<label>Masukkan Riwayat Angka (pisahkan dengan koma):</label>
<textarea id="historyInput" rows="5" placeholder="Contoh: 0,23,5,14,8,..."></textarea>

<label>Hasil Terbaru (pisahkan dengan koma/spasi):</label>
<input type="text" id="latestResult" placeholder="Contoh: 10,20,30" />

<button onclick="generatePrediction()">üîç Proses Prediksi</button>

<table>
  <thead>
    <tr>
      <th>Angka</th>
      <th>Warna</th>
      <th>Kolom</th>
      <th>Besar/Kecil</th>
      <th>Ganjil/Genap</th>
    </tr>
  </thead>
  <tbody id="resultTable"></tbody>
</table>

<div class="stats-container">
  üìä <span id="statsText">Menang: 0 | Kalah: 0</span>
  <br />
  <button class="btn-reset" onclick="resetStats()">üîÑ Reset Statistik</button>
</div>

<script>
const red = new Set([1,3,5,7,9,12,14,16,18,19,21,23,25,27,30,32,34,36]);

function getColor(n) {
  if (n === 0) return "Hijau";
  return red.has(n) ? "Merah" : "Hitam";
}
function getColumn(n) {
  if (n >= 1 && n <= 12) return 1;
  if (n >= 13 && n <= 24) return 2;
  if (n >= 25 && n <= 36) return 3;
  return "-";
}
function isBesar(n) { return n >= 19 && n <= 36; }
function isKecil(n) { return n >= 1 && n <= 18; }
function isGanjil(n) { return n % 2 === 1; }
function isGenap(n) { return n % 2 === 0 && n !== 0; }

function lawan(value, kategori) {
  if (kategori === 'warna') return value === "Merah" ? "Hitam" : "Merah";
  if (kategori === 'ganjilgenap') return value === "Ganjil" ? "Genap" : "Ganjil";
  if (kategori === 'besarkecil') return value === "Besar" ? "Kecil" : "Besar";
  if (kategori === 'kolom') return [1, 2, 3].filter(k => k !== value);
}

function generatePrediction() {
  const historyInput = document.getElementById("historyInput").value;
  const latestInput = document.getElementById("latestResult").value;
  const history = historyInput.split(",").map(n => parseInt(n.trim())).filter(n => !isNaN(n));
  const latest = latestInput.split(/[\s,]+/).map(n => parseInt(n.trim())).filter(n => !isNaN(n));
  if (history.length === 0) return alert("Masukkan minimal 1 angka riwayat!");

  const angkaAcuan = history[history.length - 1];
  const sebelumAcuan = history.slice(0, history.length - 1);

  let count = {
    warna: {Merah:0, Hitam:0},
    ganjil: 0, genap: 0,
    besar: 0, kecil: 0,
    kolom: {1:0, 2:0, 3:0}
  };

  sebelumAcuan.forEach(n => {
    const w = getColor(n);
    if (w !== "Hijau") count.warna[w]++;
    if (isGanjil(n)) count.ganjil++; else if (isGenap(n)) count.genap++;
    if (isBesar(n)) count.besar++; else if (isKecil(n)) count.kecil++;
    const c = getColumn(n);
    if ([1,2,3].includes(c)) count.kolom[c]++;
  });

  const kategoriAcuan = {
    warna: getColor(angkaAcuan),
    ganjilgenap: isGanjil(angkaAcuan) ? "Ganjil" : "Genap",
    besarkecil: isBesar(angkaAcuan) ? "Besar" : "Kecil",
    kolom: getColumn(angkaAcuan)
  };

  const dominan = {};
  for (let key in kategoriAcuan) {
    let val = kategoriAcuan[key];
    if (key === "kolom" && ![1,2,3].includes(val)) { dominan[key] = 1; continue; }
    let frek = (key === "warna") ? count.warna[val] :
              (key === "ganjilgenap") ? count[val.toLowerCase()] :
              (key === "besarkecil") ? count[val.toLowerCase()] :
              count.kolom[val];
    let total = (key === "warna") ? (count.warna.Merah + count.warna.Hitam) :
                (key === "ganjilgenap") ? (count.ganjil + count.genap) :
                (key === "besarkecil") ? (count.besar + count.kecil) :
                (count.kolom[1] + count.kolom[2] + count.kolom[3]);
    dominan[key] = (frek / total) < 0.3 ? lawan(val, key) : val;
  }

  const combined = [...history, ...latest];
  const freq = Array(37).fill(0);
  combined.forEach(n => freq[n]++);

  const minFreq = Math.min(...freq.slice(1));
  const angkaJarang = [];
  for (let i = 1; i <= 36; i++) {
    if (freq[i] === minFreq) angkaJarang.push(i);
  }

  const hasil = new Set();
  hasil.add(0);
  latest.forEach(n => hasil.add(n));

  for (let i = 1; i <= 36 && hasil.size < 18; i++) {
    const cocok = (
      getColor(i) === dominan.warna &&
      (dominan.ganjilgenap === "Ganjil" ? isGanjil(i) : isGenap(i)) &&
      (dominan.besarkecil === "Besar" ? isBesar(i) : isKecil(i)) &&
      ([].concat(dominan.kolom).includes(getColumn(i)))
    );
    if (cocok) hasil.add(i);
  }

  angkaJarang.forEach(n => {
    if (hasil.size < 18) hasil.add(n);
  });

  if (hasil.size < 18) {
    const sisaKategori = [
      { kategori: 'kolom', data: count.kolom },
      { kategori: 'warna', data: count.warna },
      { kategori: 'ganjilgenap', data: {Ganjil: count.ganjil, Genap: count.genap} },
      { kategori: 'besarkecil', data: {Besar: count.besar, Kecil: count.kecil} }
    ].sort((a, b) => {
      const sumA = Object.values(a.data).reduce((x, y) => x + y, 0);
      const sumB = Object.values(b.data).reduce((x, y) => x + y, 0);
      return sumB - sumA;
    });

    const prioritasKategori = sisaKategori[0].kategori;
    for (let i = 1; i <= 36 && hasil.size < 18; i++) {
      if (hasil.has(i)) continue;
      if (
        (prioritasKategori === 'warna' && getColor(i) === dominan.warna) ||
        (prioritasKategori === 'ganjilgenap' && ((dominan.ganjilgenap === "Ganjil" && isGanjil(i)) || (dominan.ganjilgenap === "Genap" && isGenap(i)))) ||
        (prioritasKategori === 'besarkecil' && ((dominan.besarkecil === "Besar" && isBesar(i)) || (dominan.besarkecil === "Kecil" && isKecil(i)))) ||
        (prioritasKategori === 'kolom' && [].concat(dominan.kolom).includes(getColumn(i)))
      ) {
        hasil.add(i);
      }
    }
  }

  const tbody = document.getElementById("resultTable");
  tbody.innerHTML = "";
  Array.from(hasil).slice(0, 18).forEach(n => {
    const colorClass = n === 0 ? "green-number" : red.has(n) ? "red-number" : "black-number";
    tbody.innerHTML += `<tr>
      <td class="${colorClass}">${n}</td>
      <td>${getColor(n)}</td>
      <td>${getColumn(n)}</td>
      <td>${isBesar(n) ? "Besar" : isKecil(n) ? "Kecil" : "-"}</td>
      <td>${isGanjil(n) ? "Ganjil" : isGenap(n) ? "Genap" : "-"}</td>
    </tr>`;
  });

  const updatedHistory = [...history, ...latest].slice(-100);
  document.getElementById("historyInput").value = updatedHistory.join(",");
  document.getElementById("latestResult").value = "";

  updateWinLoseStats(latest, hasil);
}

function updateWinLoseStats(latest, hasil) {
  if (!latest || latest.length === 0) return;
  let menang = parseInt(localStorage.getItem("statMenang") || "0");
  let kalah = parseInt(localStorage.getItem("statKalah") || "0");

  // Jika ada minimal 1 angka hasil terbaru ada di prediksi ‚Üí menang
  const adaYangCocok = latest.some(n => hasil.has(n));

  if (adaYangCocok) menang++;
  else kalah++;

  localStorage.setItem("statMenang", menang);
  localStorage.setItem("statKalah", kalah);

  updateStatsUI();
}

function updateStatsUI() {
  const menang = parseInt(localStorage.getItem("statMenang") || "0");
  const kalah = parseInt(localStorage.getItem("statKalah") || "0");
  document.getElementById("statsText").textContent = `Menang: ${menang} | Kalah: ${kalah}`;
}

function resetStats() {
  if (confirm("Yakin ingin reset statistik menang/kalah?")) {
    localStorage.setItem("statMenang", "0");
    localStorage.setItem("statKalah", "0");
    updateStatsUI();
  }
}

updateStatsUI();
</script>

</body>
</html>